<% cat_name = @transactions.first.category.name %>
<% if cat_name =="" %>
<%   cat_name = "None" %>
<% end %>
<h2>Categorizing: <%= cat_name %></h2>
<p></p>
<%= link_to '[Back]', categories_path %>


<%= form_tag controller: "transactions", action: "merge_categories", method: 'get' do %>
  <p>
    <%= options_for_select([['Lisbon', 1, {'data-size' => '2.8 million'}], ['Madrid', 2, {'data-size' => '3.2 million'}]], 2) %>
    <%= text_field_tag :search, params[:search] %>
    <%= submit_tag "Search", :name => nil %>
  </p>
<% end %>

<div class='transactions'>
<table class="table table-striped table-bordered ">
    <thead>
      <tr>
        <th></th>
        <th>Account name</th>
        <th>Is cleared</th>
        <th>Date</th>
        <th>Check</th>
        <th>Description</th>
        <th>Amount</th>
        <th>Category</th>
        <th>Note</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
        <% @transactions.each do |transaction| %>
            
            <tr>
                <td></td>
                <td><%= transaction.account.name %></td>
                <td><%= best_in_place transaction, :is_cleared, type: :checkbox, :path => [transaction.account, transaction] %></td>
                <td><%= best_in_place transaction, :date, type: :date, :path => [transaction.account, transaction] %></td>
                <td><%= best_in_place transaction, :check, :path => [transaction.account, transaction] %></td>
                <td><%= best_in_place transaction, :description, :path => [transaction.account, transaction] %></td>
                <td><%= best_in_place transaction, :amount, display_with: :number_to_currency, :path => [transaction.account, transaction] %></td>
                <td><%= best_in_place transaction, :category_id, :type => :select, :collection => Category::list_category_options, :path => [transaction.account, transaction] %></td>
                <td><%= best_in_place transaction, :note, :path => [transaction.account, transaction] %></td>                
                <td align="center">
                  <%= link_to raw("<i class=\"icon-pencil \"> </i>"), [transaction.account, transaction] %>
                  <%= link_to raw("<i class=\"icon-plus-sign \"> </i>"), :action => "clone", :id => transaction.id %>
                  <%= link_to raw("<i class=\"icon-trash \"> </i>"), [transaction.account, transaction], confirm: 'Are you sure?', method: :delete %>
                </td>
            </tr>
            
        <% end %>
    </tbody>
</table>
<br />


